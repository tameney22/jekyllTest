<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width">
    <title>Search Anything, Anywhere!</title>
    <link rel="stylesheet" href="http://tameney22.github.io/jekyllTest/assets/css/CETEIcean.css">
    <link rel="stylesheet" href="http://tameney22.github.io/jekyllTest/assets/css/main.css">
    <link href='https://fonts.googleapis.com/css?family=Oswald:400,700' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Roboto+Slab' rel='stylesheet' type='text/css'>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Barlow+Semi+Condensed" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="http://tameney22.github.io/jekyllTest/assets/scripts/modernizr.custom.js"></script>
    <script src="http://tameney22.github.io/jekyllTest/assets/js/CETEI.js"></script>
</head>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.0/css/all.css" integrity="sha384-lZN37f5QGtY3VHgisS14W3ExzMWZxybE1SJSEsQp9S+oqd12jhcu+A56Ebc1zFSJ" crossorigin="anonymous">
<style>
    #highlight {
            color: red;
    }

    #search:focus {
        outline:0px !important;
        -webkit-appearance:none;
        box-shadow: none !important;
    }

    #results {
        margin: auto;
        width: 50%;
    }

    form {
        width: 50%;
        margin: auto;
    }

    .spinner {
        display: none;
    }

    #results .card {
        margin: 9px 0;
    }

    #numResults {
        text-align: center;
    }
</style>
<body>

<header role="banner" class="page-header" id="top">
<div class="headerleft">
<h1 id="site-title"><a href="http://tameney22.github.io/jekyllTest" class="site-title">Huon d'Auvergne Digital Archive</a></h1>


</div>
<div class="headerright">
<nav class="site-nav">  
  
 
  <div class="dropdown">
    <button class="dropbtn">About <i class="fa fa-caret-down"></i> </button>
      <div class="dropdown-content">
        
          <a href="/about/versioning.html">Versioning</a>
        
          <a href="/about/bibliography.html">Bibliography</a>
        
          <a href="/about/citation.html">Cite our work</a>
        
          <a href="https://github.com/SteveWLU/hda">Source Code</a>
        
          <a href="/about/technical-notes.html">Technical Notes</a>
        
      
    </div>
  </div>

  
 
  <div class="dropdown">
    <button class="dropbtn">Praxis <i class="fa fa-caret-down"></i> </button>
      <div class="dropdown-content">
        
          <a href="/test-praxis.html">General Criteria</a>
        
          <a href="/b-praxis.html">Berlin Criteria</a>
        
          <a href="/t-praxis.html">Turin Criteria</a>
        
          <a href="/p-praxis.html">Padua Criteria</a>
        
          <a href="/br-praxis.html">Barbieri Fragment Criteria</a>
        
      
    </div>
  </div>

  
 
  <div class="dropdown">
    <button class="dropbtn">Editions <i class="fa fa-caret-down"></i> </button>
      <div class="dropdown-content">
        
          <a href="/editions/b-intro.html">Berlin (B)</a>
        
          <a href="/editions/t-intro.html">Turin (T)</a>
        
          <a href="/editions/p-intro.html">Padua (P)</a>
        
          <a href="/editions/br-intro.html">Barbieri Fragment (Br)</a>
        
      
    </div>
  </div>

  
 
  <div class="dropdown">
    <button class="dropbtn">Translation <i class="fa fa-caret-down"></i> </button>
      <div class="dropdown-content">
        
          <a href="/editions/bt-intro.html">Berlin Translation</a>
        
      
    </div>
  </div>

  
 
  <div class="dropdown">
    <button class="dropbtn">Search <i class="fa fa-caret-down"></i> </button>
      <div class="dropdown-content">
        
          <a href="/search/">Search Anywhere!</a>
        
      
    </div>
  </div>

  
</nav> 

</div>
<div class="headerleft">
<p>A digital edition of Huon d'Auvergne, a pre-modern, Franco-Italian Epic</p>
</div>
</header>
<main class="page-content" aria-label="Content">
    <div class="thinwrapper">
        <h2>Search Here</h2>
        <form onsubmit="searchFor();" role="search">    
            <div class="input-group mb-3">
                <input type="text" id="search" class="form-control" placeholder="Search Term" aria-label="term" aria-describedby="button-addon2" autofocus required>
                <div class="input-group-append">
                <button class="btn btn-outline-secondary" type="submit" id="button-addon2"><i class="fas fa-search"></i></button>
                </div>
            </div>
        </form>
        <h5 id="numResults"></h5>
        <div id="results">
            <div class="spinner-border spinner" role="status">
                <span class="sr-only">Loading...</span>
            </div>
            <div id="lyst"></div>
        </div>
    </div>
</main>
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx" crossorigin="anonymous"></script>
<script type="text/javascript">
    let xmlDocs = Array();
    const xmls = ["b.xml", "br.xml", "p.xml", "t.xml"]  
    
    xmls.forEach((file, index) => {
        var xhttp = new XMLHttpRequest();
        xhttp.onreadystatechange = function() {
            if (this.readyState == 4 && this.status == 200) {
                addToList(this)
            }
        };
        xhttp.open("GET", `../editions/${file}`, true);
        xhttp.send();
    })
        
    function addToList(xml) {
        let xmlDoc = xml.responseXML;
        xmlDocs.push(xmlDoc);
    }

    function searchFor() {
        event.preventDefault();
        document.getElementById("lyst").innerHTML = "";
        let resultsCount = 0;
        var loadingIcon = document.getElementsByClassName("spinner")[0];
        var table = document.getElementsByClassName("table")[0];
        loadingIcon.style.display = "block";
        var term = document.getElementById("search").value.toLowerCase();
        xmlDocs.forEach((xmlDoc, index) => {
            xmlDoc.querySelectorAll('l').forEach(line => {
                if (line.textContent.toLowerCase().includes(term)) {
                    resultsCount++;
                    //The word to put back in the span
                    var index = line.textContent.toLowerCase().indexOf(term);
                    var word = line.textContent.substring(index, index + term.length);
                    //Regular Expression is needed in the replace function
                    var reg = new RegExp(term, "gi");
                    let text = line.textContent.replace(reg, `<span id="highlight">${word}</span>`)
                    let manuscript;
                    xmlDoc.querySelectorAll('title').forEach((title, index) => {
                        if (title.getAttribute("type") == 'manuscript') {
                            manuscript = title.textContent;
                            console.log(manuscript)
                        }
                    })
                    var html = `
                    <div class="card">
                        <div class="card-body">
                            <p class="card-text">${text}</p>
                            <h6 class="card-subtitle mb-2 text-muted">${manuscript}</h6>
                            
                        </div>
                    </div>
                    `
                    //<a href="#" class="card-link">Go Here</a>  <== for the button, not implemented yet
                    document.getElementById("lyst").innerHTML += html;
                }
            });
        });
        //Result thing
        document.getElementById("numResults").innerHTML = `${resultsCount} results found!`;
        loadingIcon.style.display = "none";
    }
</script>

<footer role="contentinfo" class="page-footer">

<div class="footer">

<div class="footer-row">
  <div class="footer-column-1">
    <img id="logo_wludh" src="http://tameney22.github.io/jekyllTest/assets/images/logos/logo_wludh.png" alt="DHAT logo" style="width:60%">
  </div>
  <div class="footer-column-1">
    <img id="logo_loyola" src="http://tameney22.github.io/jekyllTest/assets/images/logos/logo_loyola.svg" alt="DHAT logo" style="width:60%">
  </div>
  <div class="footer-column-1">
    <img id="logo_unf" src="http://tameney22.github.io/jekyllTest/assets/images/logos/logo_unf.svg" alt="DHAT logo" style="width:60%">
  </div>
  <div class="footer-column-1">
    <img id="logo_neh" src="http://tameney22.github.io/jekyllTest/assets/images/logos/logo_neh.png" alt="DHAT logo" style="width:60%">
  </div>
</div>

<div class="footer-row">
  <div class="footer-column-2">
    <img id="logo_marucelliana" src="http://tameney22.github.io/jekyllTest/assets/images/logos/logo_marucelliana.png" alt="DHAT logo" style="width:25%">
  </div>
  <div class="footer-column-2">
    <img id="logo_archiginnasio" src="http://tameney22.github.io/jekyllTest/assets/images/logos/logo_archiginnasio.png" alt="DHAT logo" style="width:20%">
  </div>
  <div class="footer-column-2">
    <img id="logo_vescovile" src="http://tameney22.github.io/jekyllTest/assets/images/logos/logo_vescovile.jpg" alt="DHAT logo" style="width:85%">
  </div>
</div>

<p class="legal">&copy; <a href="https://www.wlu.edu/romance-languages-department/faculty-and-staff/profile?ID=x9689"
title="Stephen P. McCormick">Stephen P. McCormick</a> and <a href="https://digitalhumanities.wlu.edu/" title="lynda">
Washington & Lee Digital Humanities</a> | Site built using <a href="https://jekyllrb.com/" title="Jekyll static pages">
Jekyll static pages</a> and the <a href="https://www.tei-c.org/" title="Text Encoding Initiative">Text Encoding Initiative.</a></p>


</div>

</footer>

</body>

</html>
